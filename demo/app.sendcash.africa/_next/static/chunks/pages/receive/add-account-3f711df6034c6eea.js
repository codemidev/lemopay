(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4717],{20640:function(e,t,n){"use strict";var r=n(11742),a={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,o,u,s,i,l,c=!1;t||(t={}),n=t.debug||!1;try{if(u=r(),s=document.createRange(),i=document.getSelection(),(l=document.createElement("span")).textContent=e,l.ariaHidden="true",l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",l.addEventListener("copy",(function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),"undefined"===typeof r.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var o=a[t.format]||a.default;window.clipboardData.setData(o,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))})),document.body.appendChild(l),s.selectNodeContents(l),i.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");c=!0}catch(d){n&&console.error("unable to copy using execCommand: ",d),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),c=!0}catch(d){n&&console.error("unable to copy using clipboardData: ",d),n&&console.error("falling back to prompt"),o=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,e)}}finally{i&&("function"==typeof i.removeRange?i.removeRange(s):i.removeAllRanges()),l&&document.body.removeChild(l),u()}return c}},42318:function(e,t,n){"use strict";var r=n(85893);t.Z=function(e){return(0,r.jsxs)("label",{className:"toggle-container",htmlFor:e.inputId,children:[(0,r.jsx)("span",{className:"sr-only",children:e.label}),(0,r.jsx)("input",{checked:e.checked,type:"checkbox",id:e.inputId,onChange:e.onChange}),(0,r.jsx)("span",{className:"toggle"})]})}},8667:function(e,t,n){"use strict";n.d(t,{G:function(){return a},f:function(){return o}});var r=n(75786);function a(){r.G.apply(this)}function o(e,t){return new Promise((function(n){r.f(e,t).then((function(e){return n(e)}))}))}},73579:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=o.default,a={loading:function(e){e.error,e.isLoading;return e.pastDelay,null}};e instanceof Promise?a.loader=function(){return e}:"function"===typeof e?a.loader=e:"object"===typeof e&&(a=r({},a,e));if((a=r({},a,t)).suspense)throw new Error("Invalid suspense option usage in next/dynamic. Read more: https://nextjs.org/docs/messages/invalid-dynamic-suspense");a.loadableGenerated&&delete(a=r({},a,a.loadableGenerated)).loadableGenerated;if("boolean"===typeof a.ssr&&!a.suspense){if(!a.ssr)return delete a.ssr,u(n,a);delete a.ssr}return n(a)},t.noSSR=u;var r=n(6495).Z,a=n(92648).Z,o=(a(n(67294)),a(n(23668)));function u(e,t){return delete t.webpack,delete t.modules,e(t)}("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&"undefined"===typeof t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3982:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadableContext=void 0;var r=(0,n(92648).Z)(n(67294)).default.createContext(null);t.LoadableContext=r},23668:function(e,t,n){"use strict";var r=n(33227),a=n(88361);function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(6495).Z,i=(0,n(92648).Z)(n(67294)),l=n(3982),c=n(61688).useSyncExternalStore,d=[],p=[],f=!1;function m(e){var t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then((function(e){return n.loading=!1,n.loaded=e,e})).catch((function(e){throw n.loading=!1,n.error=e,e})),n}var h=function(){function e(t,n){r(this,e),this._loadFn=t,this._opts=n,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}return a(e,[{key:"promise",value:function(){return this._res.promise}},{key:"retry",value:function(){var e=this;this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};var t=this._res,n=this._opts;t.loading&&("number"===typeof n.delay&&(0===n.delay?this._state.pastDelay=!0:this._delay=setTimeout((function(){e._update({pastDelay:!0})}),n.delay)),"number"===typeof n.timeout&&(this._timeout=setTimeout((function(){e._update({timedOut:!0})}),n.timeout))),this._res.promise.then((function(){e._update({}),e._clearTimeouts()})).catch((function(t){e._update({}),e._clearTimeouts()})),this._update({})}},{key:"_update",value:function(e){this._state=s({},this._state,{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},e),this._callbacks.forEach((function(e){return e()}))}},{key:"_clearTimeouts",value:function(){clearTimeout(this._delay),clearTimeout(this._timeout)}},{key:"getCurrentValue",value:function(){return this._state}},{key:"subscribe",value:function(e){var t=this;return this._callbacks.add(e),function(){t._callbacks.delete(e)}}}]),e}();function y(e){return function(e,t){var n=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null,suspense:!1},t);n.suspense&&(n.lazy=i.default.lazy(n.loader));var r=null;function a(){if(!r){var t=new h(e,n);r={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return r.promise()}if(!f){var u=n.webpack?n.webpack():n.modules;u&&p.push((function(e){var t,n=o(u);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(-1!==e.indexOf(r))return a()}}catch(s){n.e(s)}finally{n.f()}}))}function d(){a();var e=i.default.useContext(l.LoadableContext);e&&Array.isArray(n.modules)&&n.modules.forEach((function(t){e(t)}))}var m=n.suspense?function(e,t){return d(),i.default.createElement(n.lazy,s({},e,{ref:t}))}:function(e,t){d();var a=c(r.subscribe,r.getCurrentValue,r.getCurrentValue);return i.default.useImperativeHandle(t,(function(){return{retry:r.retry}}),[]),i.default.useMemo((function(){return a.loading||a.error?i.default.createElement(n.loading,{isLoading:a.loading,pastDelay:a.pastDelay,timedOut:a.timedOut,error:a.error,retry:r.retry}):a.loaded?i.default.createElement((t=a.loaded)&&t.__esModule?t.default:t,e):null;var t}),[e,a])};return m.preload=function(){return a()},m.displayName="LoadableComponent",i.default.forwardRef(m)}(m,e)}function v(e,t){for(var n=[];e.length;){var r=e.pop();n.push(r(t))}return Promise.all(n).then((function(){if(e.length)return v(e,t)}))}y.preloadAll=function(){return new Promise((function(e,t){v(d).then(e,t)}))},y.preloadReady=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise((function(t){var n=function(){return f=!0,t()};v(p,e).then(n,n)}))},window.__NEXT_PRELOADREADY=y.preloadReady;var b=y;t.default=b},97816:function(e,t,n){"use strict";n.r(t);var r=n(50029),a=n(90116),o=n(92777),u=n(82262),s=n(10748),i=n(81531),l=n(63553),c=n(37247),d=n(59499),p=n(87794),f=n.n(p),m=n(34050),h=n(3914),y=n(6518),v=n(69682),b=n(96712),g=n(42318),w=n(24258),k=n(83466),x=n(53527),E=n(6704),_=n(55475),C=n(54283),Z=n(8667),j=n(69580),A=n(75268),S=n(24491),D=n(59904),I=n(99009),O=n(11163),V=n.n(O),P=n(67294),L=n(74231),R=n(9178),N=n(85893);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.Z)(e);if(t){var a=(0,c.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}var F=function(e){(0,i.Z)(n,e);var t=U(n);function n(e){var u;(0,o.Z)(this,n),u=t.call(this,e),(0,d.Z)((0,s.Z)(u),"AlertController",void 0),(0,d.Z)((0,s.Z)(u),"amountInputBackup",{amount:"",amountError:"",currency:""}),(0,d.Z)((0,s.Z)(u),"currencies",(0,a.Z)(Object.keys(x.allCurrencies))),(0,d.Z)((0,s.Z)(u),"validators",{email:(0,L.Z_)().required("Enter a valid email address").email("Please enter a valid email address"),currency:(0,L.Z_)().required("Please select a currency"),amount:(0,L.Z_)()}),(0,d.Z)((0,s.Z)(u),"backLink",{callback:V().back}),(0,d.Z)((0,s.Z)(u),"setAmount",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";u.updateValue("amount",e),u.setInputError("amount",t)})),(0,d.Z)((0,s.Z)(u),"updateValue",(function(e,t){u.setState({inputValues:T(T({},u.state.inputValues),{},(0,d.Z)({},e,t))}),u.validators[e]&&u.validateFormInput(e,t)})),(0,d.Z)((0,s.Z)(u),"submit",function(){var e=(0,r.Z)(f().mark((function e(t){var n,r,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),!u.state.resolvingAccount){e.next=5;break}return u.AlertController.ready((function(e){(0,e.alert)({title:"Checking your account",body:"We're checking your account details. Please wait."})})),e.abrupt("return");case 5:if(!u.hasInvalidInput(u.state.inputValues)){e.next=9;break}return u.setState({showError:!1}),u.AlertController.ready((function(e){(0,e.alert)({title:"Invalid input",body:"Please check your inputs and try again.",actions:[{label:"OK",callback:function(){return u.setState({showError:!0})}}]})})),e.abrupt("return");case 9:return u.setState({pageLoading:!0}),r={accountId:null===(n=u.state.resolvedAccountData)||void 0===n?void 0:n.id},u.state.hideEmailInput||(r.email=u.state.inputValues.email),u.state.showAmountInput&&(r.amount=u.state.inputValues.amount,r.currency=u.state.inputValues.currency,r.hasFixedAmount=!0),window.trackEvents({type:"action",properties:{event:"toggled fixed amount button",value:u.state.showAmountInput?"on":"off"}}),e.next=16,E.Z.request("payment-links/create","POST",r);case 16:a=e.sent,u.setState({paymentLink:a,showPaymentLinkModal:!0,pageLoading:!1}),window.trackEvents({type:"action",properties:{event:"Created payment link"}}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),u.setState({pageError:(0,D.filterErrorMessage)((null===e.t0||void 0===e.t0?void 0:e.t0.message)||e.t0),pageLoading:!1});case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t){return e.apply(this,arguments)}}()),(0,d.Z)((0,s.Z)(u),"toggleFixedAmount",function(){var e=(0,r.Z)(f().mark((function e(t){var n,r,a,o,s,i,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.target.checked)){e.next=10;break}return r=u.amountInputBackup,a=r.amount,o=r.currency,s=r.amountError,e.next=5,u.updateValue("currency",o);case 5:return e.next=7,u.setAmount(a,s);case 7:u.setState({showAmountInput:n}),e.next=18;break;case 10:i=u.state.inputValues,l=u.state.inputErrors,u.amountInputBackup={currency:i.currency,amount:i.amount,amountError:l.amount},i.amount=void 0,l.amount=void 0,i.currency=void 0,l.currency=void 0,u.setState({showAmountInput:n,inputValues:i,inputErrors:l});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,d.Z)((0,s.Z)(u),"dismissPaymentLinkModal",(function(){u.setState({showPaymentLinkModal:!1}),V().back()})),Z.G.apply((0,s.Z)(u));var i=u.props.currentUser;if(u.state={showPaymentLinkModal:!1,resolvedAccountData:null,resolvingAccount:!1,hideEmailInput:!(null===i||void 0===i||!i.id)&&!(null===i||void 0===i||!i.username)&&!(null===i||void 0===i||!i.email),showAmountInput:!1,inputValues:{bankCode:"",email:(null===i||void 0===i?void 0:i.email)||"",accountNumber:"",accountName:"",amount:"",currency:"USD"},inputErrors:{email:"",amount:"",bankInput:"",currency:""},pageError:"",pageLoading:!1,showError:!1,isDesktop:!!(0,S.S)()&&(0,C.R)()},(0,S.S)()){var l=(0,j.t)("@/global-store");u.amountInputBackup={currency:l.transaction.sourceCurrency,amount:l.transaction.amount,amountError:""}}return u}return(0,u.Z)(n,[{key:"componentDidMount",value:function(){this.AlertController=(0,j.T)("@/alert-service")}},{key:"render",value:function(){var e=this,t=this.state,n=t.hideEmailInput,r=t.showPaymentLinkModal,a=t.paymentLink,o=t.showAmountInput,u=t.isDesktop;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(A.Z,{hook:I.C,argumentsList:[],onUpdate:function(t){e.setState({isDesktop:t})}},"useIsDesktop"),(0,N.jsx)(R.Z,{open:r,paymentLink:a,onDismiss:this.dismissPaymentLinkModal}),(0,N.jsxs)("form",{className:u?"page--slim":"page--full",onSubmit:this.submit,children:[(0,N.jsx)(k.Z,{backLink:this.backLink,showCloseButton:!1}),(0,N.jsxs)("div",{className:"page__main",children:[(0,N.jsx)("h2",{className:"text-left color-dark stretch mb",children:"Enter your receiving details"}),!n&&(0,N.jsx)(v.Z,{type:"email",setValue:function(t){return e.updateValue("email",t)},value:this.state.inputValues.email,label:"Email address (required)",errorMessage:this.state.inputErrors.email,showError:this.state.showError}),(0,N.jsx)(h.Z,{countryCode:"NG",email:this.state.inputErrors.email?null:this.state.inputValues.email,values:this.state.inputValues,updateValue:this.updateValue,setInputError:function(t){e.setInputError("bankInput",t)},setFormError:function(t){e.setState({pageError:t})},setAccountData:function(t){e.setState({resolvedAccountData:t})},setResolvingAccount:function(t){e.setState({resolvingAccount:t})}}),(0,N.jsxs)("div",{className:"flex-layout-center-between my",children:[(0,N.jsx)("p",{"aria-hidden":"true",children:"Set a fixed amount"}),(0,N.jsx)(g.Z,{checked:o,inputId:"fixed-amount-toggle",onChange:this.toggleFixedAmount,label:"Set a fixed amount"})]}),this.state.showAmountInput?(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)(y.Z,{options:this.currencies,getDisplayValue:function(e,t){return(0,_.C)(e,t,{withIcon:"list"===t,preferFlags:!1})},defaultValue:this.state.inputValues.currency,setValue:function(t){return e.updateValue("currency",t)},value:this.state.inputValues.currency,label:"Currency",errorMessage:this.state.inputErrors.currency,showError:this.state.showError,gridInput:!0}),(0,N.jsx)(b.Z,{defaultValue:this.state.inputValues.amount,currency:this.state.inputValues.currency,onChange:function(t){return e.setAmount(t)},setError:function(t){e.setAmount(e.state.inputValues.amount,t)},children:function(t){return(0,N.jsx)(v.Z,T(T({},t.amountInputAttributes),{},{setValue:function(e){return t.setAmount(e)},value:t.displayValue,label:"Amount",errorMessage:t.errorMessage,showError:e.state.showError,onRejectInput:t.setRejectInputCallback,gridInput:!0}))}})]}):null]}),(0,N.jsxs)("div",{className:"page__footer",children:[(0,N.jsx)(m.Z,{errorText:this.state.pageError}),(0,N.jsx)("button",{type:"submit",disabled:this.hasInvalidInput(this.state.inputValues)||this.state.resolvingAccount,className:"button",children:this.state.resolvingAccount?"Checking account...":"Continue"})]}),(0,N.jsx)(w.Z,{show:this.state.pageLoading})]})]})}}]),n}(P.Component);(0,d.Z)(F,"getInitialProps",function(){var e=(0,r.Z)(f().mark((function e(t){var n,r,a,o,u,s,i,l,c;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.pathname,r=t.asPath,t.req,a=t.res,!(o=t.err)){e.next=3;break}throw o;case 3:if(u={title:"USD Account",path:(null===r||void 0===r?void 0:r.split("?")[0])||n,description:""},!1,e.prev=5,!(0,S.S)()){e.next=11;break}s=null===(i=(0,j.t)("@/global-store"))||void 0===i?void 0:i.currentUser,!(null===(l=s)||void 0===l||!l.id),e.next=15;break;case 11:return e.next=13,a.locals.getCurrentUser().catch((function(){return null}));case 13:s=e.sent,!(null===(c=s)||void 0===c||!c.id);case 15:e.next=24;break;case 17:if(e.prev=17,e.t0=e.catch(5),401!==e.t0.status){e.next=23;break}!1,e.next=24;break;case 23:throw e.t0;case 24:return e.abrupt("return",{meta:u,template:"app",showAppMobileNav:!1,showAppDesktopNav:!0,usesAuth:!1,currentUser:s});case 25:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t){return e.apply(this,arguments)}}()),t.default=F},80059:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/receive/add-account",function(){return n(97816)}])},5152:function(e,t,n){e.exports=n(73579)},11742:function(e){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},53250:function(e,t,n){"use strict";var r=n(67294);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useState,u=r.useEffect,s=r.useLayoutEffect,i=r.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(r){return!0}}var c="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),a=r[0].inst,c=r[1];return s((function(){a.value=n,a.getSnapshot=t,l(a)&&c({inst:a})}),[e,n,t]),u((function(){return l(a)&&c({inst:a}),e((function(){l(a)&&c({inst:a})}))}),[e]),i(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},61688:function(e,t,n){"use strict";e.exports=n(53250)}},function(e){e.O(0,[4231,4431,458,461,6518,9954,5238,3263,9774,2888,179],(function(){return t=80059,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=add-account-3f711df6034c6eea.js.map