"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5238],{3914:function(e,t,r){r.d(t,{Z:function(){return q}});var n=r(59499),o=r(67294),a=r(69580),s=r(50029),c=r(17674),i=r(92777),u=r(82262),l=r(10748),p=r(81531),d=r(63553),f=r(37247),v=r(87794),b=r.n(v),h=r(74231),m=r(5594),O=r(85893);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,f.Z)(e);if(t){var o=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var j=function(e,t,r){var o=function(o){(0,p.Z)(s,o);var a=y(s);function s(o){var c;(0,i.Z)(this,s);var u=(c=a.call(this,o)).props.options,p=Object.values(u).flat();return m.Z.apply((0,l.Z)(c),[p,e,t,r]),c.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},c.state),c}return(0,u.Z)(s,[{key:"componentDidMount",value:function(){this.onMount()}},{key:"componentDidUpdate",value:function(e,t){if(this.onUpdate(e,t),this.props.options!==e.options){var r=Object.values(this.props.options).flat(),n=Object.values(e.options).flat();this.handleUpdatedOptionsList(r,n)}}},{key:"render",value:function(){var e,t=this,r=this.props,n=r.options,o=r.filteredOptions;return[this.renderSelectInputButton(),this.renderOptionsModal((0,O.jsx)("ul",{children:null===(e=Object.entries(o||n))||void 0===e?void 0:e.map((function(e,r){var n=(0,c.Z)(e,2),o=n[0],a=n[1];return(null===a||void 0===a?void 0:a.length)>0?(0,O.jsxs)("li",{children:[(0,O.jsx)("h3",{className:"px-s mt pt",children:(0,O.jsx)("span",{className:"small uppercase strong color-neutral-gray",children:o})}),(0,O.jsx)("ul",{children:a.map(t.renderOptionListItem)})]},"".concat(o,"-").concat(r)):null}))}))]}}]),s}(e.Component);return o},g=r(62349),Z=r(33617),N=r(82730),x=function(e){return e.sort((function(e,t){return e.name>t.name?1:-1}))},E=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return{popular:{codes:[],details:{}},all:{codes:[],details:{}}};var r=t?x(e):e,n={codes:[],details:{}},o={codes:[],details:{}};return r.forEach((function(e){var t;!e.code||e.code.trim().length<1||(n.details[e.code]||o.details[e.code]||(N.popularBanks.some((function(r,n){var o,a,s=r.code===e.code&&(null===(o=r.name)||void 0===o?void 0:o.toLowerCase())===(null===(a=e.name)||void 0===a?void 0:a.toLowerCase());return s&&(t=n),s}))?(n.codes[t]=e.code,n.details[e.code]=e):(o.codes.push(e.code),o.details[e.code]=e)))})),{popular:n,all:o}},w=r(59904),A=r(24491),C=r(75786),P=r(6704);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,f.Z)(e);if(t){var o=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var I,R=function(e,t,r,o){var a=o.renderBankSelectOption,d=o.filterBankSelectOptions,f=Z.Q.createComponent(e,(function(){return null})),v=j(e,f,t),m=g.n.createComponent(e),k=function(e){(0,p.Z)(o,e);var t=B(o);function o(e){var a;(0,i.Z)(this,o),a=t.call(this,e),(0,n.Z)((0,l.Z)(a),"resolveAccountTimeout",void 0),(0,n.Z)((0,l.Z)(a),"validators",{bankCode:(0,h.Z_)().required("Please select the receiving bank"),accountNumber:(0,h.Z_)().required("Recipient's account number is required").matches(/^[0-9]{10}$/,"Please enter a 10-digit NUBAN account number"),accountName:(0,h.Z_)().required()}),(0,n.Z)((0,l.Z)(a),"lastResolvedAccount",{bankCode:"",accountNumber:""}),(0,n.Z)((0,l.Z)(a),"Store",void 0),(0,n.Z)((0,l.Z)(a),"publishErrorMessage",(function(e){for(var t=Object.entries(a.state.inputErrors),r=Object.entries(e.inputErrors),n="",o=!1,s=0;s<r.length;s++){var i=(0,c.Z)(r[s],2),u=(i[0],i[1]);if(u){n=u;break}}for(var l=0;l<t.length;l++){var p=(0,c.Z)(t[l],2),d=(p[0],p[1]);if(d){o=!0,d!==n&&a.props.setInputError(d);break}}!o&&n&&a.props.setInputError("")})),(0,n.Z)((0,l.Z)(a),"storeBanksList",(function(e){a.Store.createScope("banks",(0,n.Z)({},a.props.countryCode,e),{NG:"nigerian_banks"})})),(0,n.Z)((0,l.Z)(a),"revalidateAccountNumber",(function(){var e=a.props.values,t=e.accountNumber,r=e.bankCode,n=a.state.inputErrors.bankCode,o=a.state.inputErrors.accountNumber;!t||!r||n||o||a.state.resolvedAccountData||a.resolveAccountNumber()})),(0,n.Z)((0,l.Z)(a),"resolveAccountNumber",(function(){var e=a.props.values,t=e.accountNumber,r=void 0===t?"":t,n=e.bankCode,o=void 0===n?"":n;a.lastResolvedAccount={accountNumber:r,bankCode:o},a.state.resolvingAccount||a.setState({resolvingAccount:!0}),clearTimeout(a.resolveAccountTimeout),a.resolveAccountTimeout=window.setTimeout((0,s.Z)(b().mark((function e(){var t,n,s,c,i,u,l,p;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.resolveAccountTimeout,n=function(){var e=r!==a.props.values.accountNumber,n=o!==a.props.values.bankCode;return!(!e&&!n)&&(a.lastResolvedAccount={accountNumber:"",bankCode:""},t===a.resolveAccountTimeout&&a.setState({resolvingAccount:!1}),!0)},e.prev=2,s={accountNumber:r,bankCode:o,countryCode:a.props.countryCode,recipientEmail:a.props.email||null},e.next=6,P.Z.request("banks/resolve-account","POST",s);case 6:if(c=e.sent,!n()){e.next=10;break}return e.abrupt("return");case 10:i=(0,w.getFullName)(c.accountName),u=(0,w.getLastName)(i),l=(0,w.getFirstName)(i),p=D(D({},c),{},{accountName:i,lastName:u,firstName:l}),a.setState({resolvedAccountData:p,resolvingAccount:!1,formError:""}),a.validateFormInput("accountName",i),e.next=25;break;case 18:if(e.prev=18,e.t0=e.catch(2),!n()){e.next=23;break}return e.abrupt("return");case 23:console.error(e.t0),a.setState({resolvingAccount:!1,formError:"We were unable to find that account, please check that the details are correct."});case 25:case"end":return e.stop()}}),e,null,[[2,18]])}))),300)})),(0,n.Z)((0,l.Z)(a),"getBanks",(0,s.Z)(b().mark((function e(){var t,r,n,o,s,c=arguments;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c.length>0&&void 0!==c[0]&&c[0],r=a.props.countryCode;try{n=null===(o=a.Store.fetch("banks"))||void 0===o?void 0:o[r]}catch(i){}if(n&&!t){e.next=10;break}return e.next=6,P.Z.request("banks/".concat(r)).catch((function(e){return console.log(e)}));case 6:n=e.sent,a.storeBanksList(n),e.next=11;break;case 10:setTimeout((function(){a.getBanks(!0)}),1e3);case 11:if(n){e.next=14;break}return a.setState({formError:"There was an error fetching the list of banks. Please try again."}),e.abrupt("return");case 14:s=E(n),a.setState({banks:{popular:s.popular.details,all:s.all.details},bankCodes:{popular:s.popular.codes,all:s.all.codes}});case 16:case"end":return e.stop()}}),e)})))),(0,n.Z)((0,l.Z)(a),"filterBankOptions",(function(e){var t=a.state,r=t.bankCodes,n=t.banks;a.setState({banksSearchKey:e,filteredBankCodes:d(e,r,n)})})),C.G.apply((0,l.Z)(a)),(0,A.S)()&&(a.Store=r);var u=a.props.banks?E(a.props.banks):null;return a.state={banks:{popular:(null===u||void 0===u?void 0:u.popular.details)||{},all:(null===u||void 0===u?void 0:u.all.details)||{}},bankCodes:{popular:(null===u||void 0===u?void 0:u.popular.codes)||[],all:(null===u||void 0===u?void 0:u.all.codes)||[]},banksSearchKey:"",filteredBankCodes:void 0,resolvedAccountData:null,resolvingAccount:!1,inputErrors:{bankCode:"",accountNumber:"",accountName:""}},a}return(0,u.Z)(o,[{key:"componentDidMount",value:function(){var e=this;this.props.banks?this.storeBanksList(this.props.banks):this.getBanks(),Object.keys(this.validators).forEach((function(t){e.validateFormInput(t,e.props.values[t])}))}},{key:"componentDidUpdate",value:function(e,t){var r,n,o=this;this.state.resolvingAccount!==t.resolvingAccount&&this.props.setResolvingAccount(this.state.resolvingAccount),this.state.formError!==t.formError&&this.props.setFormError(this.state.formError),(null===(r=this.state.resolvedAccountData)||void 0===r?void 0:r.id)!==(null===(n=t.resolvedAccountData)||void 0===n?void 0:n.id)&&this.props.setAccountData(this.state.resolvedAccountData),this.publishErrorMessage(t),Object.entries(this.props.values).forEach((function(t){var r=(0,c.Z)(t,2),n=r[0],a=r[1];a!==e.values[n]&&o.validateFormInput(n,a)}));var a=this.props.values,s=a.accountNumber,i=a.bankCode,u=this.lastResolvedAccount.accountNumber,l=this.lastResolvedAccount.bankCode;s===u&&i===l||(this.state.resolvedAccountData||this.state.formError)&&this.setState({resolvedAccountData:null,formError:""}),s===u&&i===l||this.revalidateAccountNumber()}},{key:"render",value:function(){var e,t=this,r=this.props.BankSelectComponent||v,n=this.props.AccountNumberInput||f,o=this.props.AccountNameDisplayComponent||m;return[(0,O.jsx)(r,{options:this.state.bankCodes,filteredOptions:this.state.filteredBankCodes,search:this.filterBankOptions,searchKey:this.state.banksSearchKey,getDisplayValue:function(e,r){return a(e,r,t.state.banks)},setValue:function(e){return t.props.updateValue("bankCode",e)},value:this.props.values.bankCode,label:"Select Bank (required)",errorMessage:this.state.inputErrors.bankCode},"bank-select"),(0,O.jsx)(n,{type:"text",inputMode:"numeric",autoComplete:"cc-number",setValue:function(e){return t.props.updateValue("accountNumber",e)},value:this.props.values.accountNumber,label:"Account Number (required)",errorMessage:this.state.inputErrors.accountNumber},"account-number-input"),(0,O.jsx)(o,{label:"Account Name",isListItem:!1,children:null===(e=this.state.resolvedAccountData)||void 0===e?void 0:e.accountName},"account-name-display")]}}]),o}(e.Component);return k},L=r(3132),_=function(e,t,r){return function(e,t,r,n){for(var o,a,s,c,i=Object.keys(r),u=0;u<i.length;u++){var l=i[u],p=e;if(r[l][p]){o=r[l][p];break}}return"selected"===t?{jsx:(0,O.jsx)("span",{className:"flex justify-start",children:(0,O.jsx)("span",{children:(null===(a=o)||void 0===a?void 0:a.name)||""})}),text:(null===(s=o)||void 0===s?void 0:s.name)||"unknown"}:{label:(0,O.jsx)("span",{className:"flex justify-start",children:(0,O.jsx)("span",{children:(null===(c=o)||void 0===c?void 0:c.name)||""})}),badge:void 0,disabled:!1}}(e,t,r)},T=function(e,t,r){return function(e,t,r){var n={};if(e)return Object.keys(t).forEach((function(o){var a=t[o].filter((function(t){try{return r[o][t].name.toLowerCase().includes(e.toLowerCase())}catch(n){return(0,L.Z)(n),!1}}));a.length>0&&(n[o]=a)})),n}(e,t,r)},F=r(51557);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var q=function(e){var t=(0,o.useState)(!1),r=t[0],s=t[1];return(0,o.useEffect)((function(){var e=(0,a.t)("@/global-store"),t={renderBankSelectOption:_,filterBankSelectOptions:T};I=R(o,F.Z,e,t),s(!0)}),[]),r?(0,O.jsx)(I,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e)):null}},54283:function(e,t,r){r.d(t,{R:function(){return n}});var n=function(){return window.innerWidth>=800}},75786:function(e,t,r){r.d(t,{G:function(){return s},f:function(){return c}});var n=r(59499);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(){var e=this;this.setInputError=function(t,r){e.setState({inputErrors:a(a({},e.state.inputErrors),{},(0,n.Z)({},t,r))})},this.validateFormInput=function(t,r){var n;null===(n=e.validators[t])||void 0===n||n.validate(r).then((function(){return e.setInputError(t,"")})).catch((function(r){return e.setInputError(t,r.message)}))},this.validateAll=function(t){Object.keys(e.validators).forEach((function(r){e.validateFormInput(r,t[r])}))},this.hasInvalidInput=function(t){return Object.keys(t).some((function(t){return!!e.state.inputErrors[t]}))}}function c(e,t){return new Promise((function(r){t.validate(e).then((function(){return r("")})).catch((function(e){return r(e.message)}))}))}},62349:function(e,t,r){r.d(t,{n:function(){return o}});var n=r(85893),o={createComponent:function(e){var t=function(e){var t=e.children;return e.isListItem?(0,n.jsx)("div",{className:"text-input text-input--disabled mb",children:t}):(0,n.jsx)("dl",{className:"text-input text-input--disabled mb",children:t})};return function(e){var r=e.label,o=e.children,a=e.isListItem;return(0,n.jsxs)(t,{isListItem:a,children:[(0,n.jsx)("dt",{className:["text-input__label",o?"active":""].join(" "),children:r}),(0,n.jsx)("dd",{className:"text-input__input active",children:o||(0,n.jsx)(n.Fragment,{children:"\xa0"})})]})}}}}}]);
//# sourceMappingURL=5238-4ff6f9e04119b8c7.js.map